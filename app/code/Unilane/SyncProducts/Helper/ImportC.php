<?php
/**
 * Copyright © Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
namespace Unilane\SyncProducts\Helper;

use Magento\Catalog\Api\Data\ProductInterfaceFactory;
use Magento\Catalog\Api\ProductRepositoryInterface;

/**
 * Adminhtml Catalog helper
 *
 * @author     Magento Core Team <core@magentocommerce.com>
 */
class ImportC 
{
    private $productFactory;
    private $productRepository;
    /**
     * Constructor
     *
     * @param \Magento\Backend\App\Action\Context $context     
     */
    public function __construct(
        ProductInterfaceFactory $productFactory,
        ProductRepositoryInterface $productRepository
    ) {
        $this->productFactory = $productFactory;
        $this->productRepository = $productRepository;

    }
    /**
     * Set Custom Attribute Tab Block Name for Category Edit
     *
     * @param string $attributeTabBlock
     * @return $this
     */
    public function importProduct(){
        $jsonCT = $this->connectCT();
        
        $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/importCronProductData.log');
        $logger = new \Zend_Log();
        $logger->addWriter($writer);
        $logger->info("Inicio de la importacion del cron de productos");

        try{
            if($jsonCT){
                $logger->info("");
                $objectManager = \Magento\Framework\App\ObjectManager::getInstance();
                $mediaDir = $objectManager->get('Magento\Framework\App\Filesystem\DirectoryList')->getPath('media');
                //CT
                $dataCt  = file_get_contents("/home/imagended/productos.json");        
                $productsData  = json_decode($dataCt, true);
                $data = [];
                $sku = [];
                foreach($productsData as $key => $productdata){
                    $producto = $this->productRepository->get($productdata['clave']);
                    if($producto == null){                
                        array_push($data, $productdata);           
                    }        
                }
                if($data){
                    foreach($data as $product){
                        $items = $this->productFactory->create();
                        $sumaExistencia = 0;
                        $pro = $product['existencia'];
                        foreach($pro as $existencia){
                            $sumaExistencia += $existencia;
                        }
                        $precioIva = $productdata['precio'] * 1.16;                
                        $precioivaxtipocambio = $precioIva * $productdata['tipoCambio'];
                        $precioReal = $precioivaxtipocambio * 1.05;
                        $numero_formateado = number_format($precioReal, 2, '.', '');
                        $precio_desgloce = explode(".",$numero_formateado);
                        $precioReal = $this->redondeo($precio_desgloce);
                        $nombreCategoria = $product['subcategoria'];

                        #region Cámaras de Video Vigilancia                        
                        if($nombreCategoria == "Cámaras de Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,209
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Cámara bala análogica
                        if($nombreCategoria == "Cámara bala análogica"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);
                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,209
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Cámaras domo analógicas
                        if($nombreCategoria == "Cámaras domo analógicas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,209
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Cámaras PTZ analógicas
                        if($nombreCategoria == "Cámaras PTZ analógicas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,209
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }              
                        #endregion
                        #region Cables USB
                        if($nombreCategoria == "Cables USB"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,245
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Adaptadores de Energía
                        if($nombreCategoria == "Adaptadores de Energía"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,243
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Inversores de Energia
                        if($nombreCategoria == "Inversores de Energia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,243
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Reemplazos
                        if($nombreCategoria == "Reemplazos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,234,242
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Supresores
                        if($nombreCategoria == "Supresores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,261,239
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");    
                        }
                        #endregion
                        #region Regletas y Multicontactos
                        if($nombreCategoria == "Regletas y Multicontactos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,261,238
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Estaciones de Carga
                        if($nombreCategoria == "Estaciones de Carga"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,261,278
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }  
                        #endregion
                        #region Reguladores
                        if($nombreCategoria == "Reguladores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,236
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region No Breaks y UPS
                        if($nombreCategoria == "No Breaks y UPS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,235
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Baterías
                        if($nombreCategoria == "Baterías"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,234
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Barra de Contactos
                        if($nombreCategoria == "Barra de Contactos"){ 
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);                    
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,233
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }    
                        #endregion
                        #region Tarjetas de Acceso
                        if($nombreCategoria == "Tarjetas de Acceso"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,223
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion 
                        #region Accesorios para seguridad
                        if($nombreCategoria == "Accesorios para seguridad"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,217
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Soportes para Video Vigilancia
                        if($nombreCategoria == "Soportes para Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,262,215
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Monitores para Video Vigilancia
                        if($nombreCategoria == "Monitores para Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,262,213
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Kits de Video Vigilancia
                        if($nombreCategoria == "Kits de Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,212
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Grabadoras Digitales
                        if($nombreCategoria == "Grabadoras Digitales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,211
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Grabadores analógicos
                        if($nombreCategoria == "Grabadores analógicos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,211
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Fuentes de Poder para Video Vigilancia
                        if($nombreCategoria == "Fuentes de Poder para Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,262,210
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Cámaras
                        if($nombreCategoria == "Cámaras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,40,125
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion 
                        #region Cables y conectores
                        if($nombreCategoria == "Cables y conectores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,262,208
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Inyectores PoE
                        if($nombreCategoria == "Inyectores PoE"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,206
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Antenas
                        if($nombreCategoria == "Antenas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,205
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Accesorios para Racks
                        if($nombreCategoria == "Accesorios para Racks"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,204
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Racks Modulo
                        if($nombreCategoria == "Racks Modulo"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,204
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Switches
                        if($nombreCategoria == "Switches"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,203
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Amplificadores Wifi
                        if($nombreCategoria == "Amplificadores Wifi"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,202
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Extensores de Red
                        if($nombreCategoria == "Extensores de Red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,202
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Hub y Concentadores Wifi
                        if($nombreCategoria == "Hub y Concentadores Wifi"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,202
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Routers
                        if($nombreCategoria == "Routers"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,201
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Access Points
                        if($nombreCategoria == "Access Points"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,200
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Accesorios para Cables
                        if($nombreCategoria == "Accesorios para Cables"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,283
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");     
                        }
                        #endregion
                        #region Herramientas para red
                        if($nombreCategoria == "Herramientas para red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,197
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Accesorios de Redes
                        if($nombreCategoria == "Accesorios de Redes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,62,197
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Bobinas
                        if($nombreCategoria == "Bobinas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,280
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Herramientas
                        if($nombreCategoria == "Herramientas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,281,282
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Jacks
                        if($nombreCategoria == "Jacks"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,284
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Convertidor de medios
                        if($nombreCategoria == "Convertidor de medios"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,103
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Transceptores
                        if($nombreCategoria == "Transceptores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Consumibles POS
                        if($nombreCategoria == "Consumibles POS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,196
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Etiquetas
                        if($nombreCategoria == "Etiquetas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,196
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Cables POS
                        if($nombreCategoria == "Cables POS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,285
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Digitalizadores de Firmas
                        if($nombreCategoria == "Digitalizadores de Firmas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,260,194
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Terminales POS
                        if($nombreCategoria == "Terminales POS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,260,193
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Monitores POS
                        if($nombreCategoria == "Monitores POS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,260,192
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Lectores de Códigos de Barras
                        if($nombreCategoria == "Lectores de Códigos de Barras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,191
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Impresoras POS
                        if($nombreCategoria == "Impresoras POS"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,190
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Cajones de Dinero
                        if($nombreCategoria == "Cajones de Dinero"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,189
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");      
                        }
                        #endregion
                        #region Kit Punto de Venta
                        if($nombreCategoria == "Kit Punto de Venta"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,61,260,188
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Pcs de Escritorio Gaming
                        if($nombreCategoria == "Pcs de Escritorio Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,187
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Monitores Gaming
                        if($nombreCategoria == "Monitores Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,186
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Laptops Gaming
                        if($nombreCategoria == "Laptops Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,185
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");    
                        }
                        #endregion
                        #region Tarjetas de Video Gaming
                        if($nombreCategoria == "Tarjetas de Video Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,185
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Tarjetas de Video
                        if($nombreCategoria == "Tarjetas de Video"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,185
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Controles
                        if($nombreCategoria == "Controles"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,286
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Consolas y Video Juegos
                        if($nombreCategoria == "Consolas y Video Juegos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,287
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Controles Gaming
                        if($nombreCategoria == "Controles Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,183
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Pilas
                        if($nombreCategoria == "Pilas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,288
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Escritorio Gaming
                        if($nombreCategoria == "Escritorio Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,182
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Sillas Gaming
                        if($nombreCategoria == "Sillas Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,181
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion 
                        #region Motherboards Gaming
                        if($nombreCategoria == "Motherboards Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,180
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Gabinetes Gaming
                        if($nombreCategoria == "Gabinetes Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,179
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Fuentes de Poder Gaming
                        if($nombreCategoria == "Fuentes de Poder Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,60,178
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Kits de Teclado y Mouse Gaming
                        if($nombreCategoria == "Kits de Teclado y Mouse Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,177
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Teclados Gaming
                        if($nombreCategoria == "Teclados Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,176
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Mouse Gaming
                        if($nombreCategoria == "Mouse Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,175
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Mouse Pads Gaming
                        if($nombreCategoria == "Mouse Pads Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,175
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Diademas Gaming
                        if($nombreCategoria == "Diademas Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,59,174
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Sensores
                        if($nombreCategoria == "Sensores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,169
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Sensores para Vídeo Vigilancia
                        if($nombreCategoria == "Sensores para Vídeo Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,169,289
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion 
                        #region Sensores Wifi
                        if($nombreCategoria == "Sensores Wifi"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,169,163
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Paneles para Alarma
                        if($nombreCategoria == "Paneles para Alarma"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,168
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Adaptadores USB
                        if($nombreCategoria == "Adaptadores USB"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,106
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Accesorios para PCs
                        if($nombreCategoria == "Accesorios para PCs"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,290
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Kits para Teclado y Mouse
                        if($nombreCategoria == "Kits para Teclado y Mouse"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,32,291
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Acceso
                        if($nombreCategoria == "Acceso"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,167
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Cámara Inteligentes
                        if($nombreCategoria == "Cámara Inteligentes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,56,165
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Cerraduras
                        if($nombreCategoria == "Cerraduras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,56,164
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Timbres
                        if($nombreCategoria == "Timbres"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,56,164
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion 
                        #region Contactos Inteligentes Wifi
                        if($nombreCategoria == "Contactos Inteligentes Wifi"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,56,160
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Control Inteligente
                        if($nombreCategoria == "Control Inteligente"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,286
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Iluminación
                        if($nombreCategoria == "Iluminación"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,56,161
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Interruptores Wifi
                        if($nombreCategoria == "Interruptores Wifi"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,292
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Control de Acceso
                        if($nombreCategoria == "Control de Acceso"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,55,159
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Checadores
                        if($nombreCategoria == "Checadores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,167,293
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Lector de Huella
                        if($nombreCategoria == "Lector de Huella"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,57,167,294
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Equipo
                        if($nombreCategoria == "Equipo"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,54,156
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Termómetros
                        if($nombreCategoria == "Termómetros"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,54,296
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Desinfectantes
                        if($nombreCategoria == "Desinfectantes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,54,155
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Caretas
                        if($nombreCategoria == "Caretas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,54,154
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion 
                        #region Cubrebocas
                        if($nombreCategoria == "Cubrebocas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,54,154
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Aspiradoras
                        if($nombreCategoria == "Aspiradoras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,257,153
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Microondas
                        if($nombreCategoria == "Microondas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,257,152
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Aires Acondicionados
                        if($nombreCategoria == "Aires Acondicionados"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,257,151
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Pantallas Profesionales
                        if($nombreCategoria == "Pantallas Profesionales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,150
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Video Conferencia
                        if($nombreCategoria == "Video Conferencia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,149
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Análogos
                        if($nombreCategoria == "Análogos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,297,298
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Central Telefónica
                        if($nombreCategoria == "Central Telefónica"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,297,299
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Teléfonos Analógicos
                        if($nombreCategoria == "Teléfonos Analógicos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148,300
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Teléfonos Digitales
                        if($nombreCategoria == "Teléfonos Digitales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148,301
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Teléfonos IP
                        if($nombreCategoria == "Teléfonos IP"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148,302
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Teléfonos para Hogar
                        if($nombreCategoria == "Teléfonos para Hogar"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148,303
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Teléfonos SIP
                        if($nombreCategoria == "Teléfonos SIP"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148,304
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Escritorio de Oficina
                        if($nombreCategoria == "Escritorio de Oficina"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,258,147
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Ergonomia
                        if($nombreCategoria == "Ergonomia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,281,305
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Sillas de Oficina
                        if($nombreCategoria == "Sillas de Oficina"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,257,146
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Almacenamiento Óptico
                        if($nombreCategoria == "Almacenamiento Óptico"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,306
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Quemadores DVD y BluRay
                        if($nombreCategoria == "Quemadores DVD y BluRay"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143,145
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Accesorios de Papeleria
                        if($nombreCategoria == "Accesorios de Papeleria"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Articulos de Escritura
                        if($nombreCategoria == "Articulos de Escritura"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion 
                        #region Basico de Papeleria
                        if($nombreCategoria == "Basico de Papeleria"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion 
                        #region Cuadernos
                        if($nombreCategoria == "Cuadernos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Papelería
                        if($nombreCategoria == "Papelería"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Plumas Interactivas
                        if($nombreCategoria == "Plumas Interactivas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,52,143
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Mantenimiento
                        if($nombreCategoria == "Mantenimiento"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,44,142
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Refacciones
                        if($nombreCategoria == "Refacciones"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,44,141
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Cabezales
                        if($nombreCategoria == "Cabezales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,44,140
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Accesorios para impresoras
                        if($nombreCategoria == "Accesorios para impresoras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,44,139
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Cintas
                        if($nombreCategoria == "Cintas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,138
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Papel
                        if($nombreCategoria == "Papel"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,137
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Tóners
                        if($nombreCategoria == "Tóners"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,136
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Cartuchos
                        if($nombreCategoria == "Cartuchos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,135
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion 
                        #region Plotters
                        if($nombreCategoria == "Plotters"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,42,134
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Rotuladores
                        if($nombreCategoria == "Rotuladores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,42,133
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
        
                        }
                        #endregion
                        #region Escaner
                        if($nombreCategoria == "Escaner"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,42,132
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Multifuncionales
                        if($nombreCategoria == "Multifuncionales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,42,131
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Impresoras
                        if($nombreCategoria == "Impresoras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,42,130
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion 
                        #region Soporte para TV
                        if($nombreCategoria == "Soporte para TV"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,129
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Soporte Videowall
                        if($nombreCategoria == "Soporte Videowall"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,129
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Soportes
                        if($nombreCategoria == "Soportes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,129
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Soporte para Proyector
                        if($nombreCategoria == "Soporte para Proyector"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,128
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Limpieza
                        if($nombreCategoria == "Limpieza"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,41,127
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        #endregion
                        #region Accesorios para Camaras
                        if($nombreCategoria == "Accesorios para Camaras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,40,125
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion 
                        #region Lentes
                        if($nombreCategoria == "Lentes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,40,124
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Micrófonos
                        if($nombreCategoria == "Micrófonos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,122
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Home Theaters
                        if($nombreCategoria == "Home Theaters"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);


                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,120
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        #endregion
                        #region Bocina Portatil
                        if($nombreCategoria == "Bocina Portatil"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,120
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        #region Bocinas
                        if($nombreCategoria == "Bocinas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,120
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        #endregion
                        if($nombreCategoria == "Bocinas Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,120
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Bocinas y Bocinas Portátiles"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,120
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Base Diademas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,119
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Diademas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,119
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria =="Audífonos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Audífonos para Apple"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Auriculares"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Earbuds"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "In Ears"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "On Ear"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "on-ear"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Reproductores MP3"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,118
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Patinetas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,117
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Streaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,307
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Televisiones"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,116
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Pantallas de Proyección"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,115
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Proyectores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,115
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Power banks"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,114
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Smartwatch"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,113
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Cables Lightning"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,308
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");      
                        }
                        if($nombreCategoria == "Cargadores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,256,112
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Accesorios para Celulares"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,256,309
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Bases"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,91
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Celulares"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,256,111
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Equipo para Celulares"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,256,310
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Transmisores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,311
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Gabinetes para Discos Duros"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,110
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Memorias Flash"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,109
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Memorias USB"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,109
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Adaptadores para Disco Duro"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,107
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Almacenamiento Externo"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,108
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Discos Duros"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,108
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Discos Duros Externos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,108
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "SSD"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,37,108
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Cables de Alimentación"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,99
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables de Audio"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,100
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables de Video"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,101
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables Serial"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,102
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Cables de Red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,199
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Cables Coaxial"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,271
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables Displayport"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,272
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables DVI"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,273
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables HDMI"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,274
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables KVM"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,275
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Cables VGA"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,276
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        
                        if($nombreCategoria == "Cables de Energía"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,252,263
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Adaptadores para Video"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,104
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores USB"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,106
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores HDMI"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,264
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores de Ethernet"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,265
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores Displayport"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,266
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores para Apple"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,267
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores para Red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,198
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores para Audio"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,268
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores USB para Video"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,269
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores USB Red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,270
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "Fundas y Maletines"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,249
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Mochila Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,40,123
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if( $nombreCategoria == "Mochilas y Maletines"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,40,123
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Fundas Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,249
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Fundas para Tablets"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,249
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Protectores para Tablets"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,249
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Filtro de Privacidad"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,94
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Concentradores Hub"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,243
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Docking Station"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,93
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Candados Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,92
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Bases Enfriadoras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,91
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Accesorios para Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,90
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores para Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,312
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Baterias Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,90
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Pantallas Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,90
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Teclados Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Tarjetas de Sonido"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Tarjetas Paralelas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Tarjetas Seriales"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Motherboards"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,88
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Microprocesadores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,87
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Memorias RAM"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,86
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Lectores de Memorias"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,85
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Gabinetes para Computadoras"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,84
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Fuentes de Poder"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,83
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Enfriamiento y Ventilación"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,82
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Webcams"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,33,81
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        if($nombreCategoria == "Soporte de Monitor"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,33,80
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Soporte Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,97
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Soportes para PCs"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,97
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Monitores"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,33,79
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Monitores Curvos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,33,79
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado"); 
                        }
                        if($nombreCategoria == "Teclados"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,32,77
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Mouse"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,32,76
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Mouse Pads"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,32,76
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "iPad"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,75
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        if($nombreCategoria == "Soporte para Tablets"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,75
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        if($nombreCategoria == "Tabletas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,75
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");
                        }
                        if($nombreCategoria == "Workstations de Escritorio"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,74
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Workstations Gaming"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,74
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Workstations Móviles"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,74
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Mini PC"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,73
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
        
                        if($nombreCategoria == "PCs de Escritorio"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,70
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Laptops"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,69
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "MacBook"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,69
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "All In One"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,68
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "iMac"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,31,68
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Accesorios para Apple"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,38,256,309
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores Inalámbricos"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,315
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Aires Acondicionados para Centros"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,257,151
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }     
                        if($nombreCategoria == "Bancos de Batería"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,67,234,241
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }       
                        if($nombreCategoria == "Micro y Mini Componentes"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Accesorios para Video Vigilancia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,63,262,210
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }    
                        if($nombreCategoria == "Accesorios para Telefonia"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,53,148
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }      
                        if($nombreCategoria == "Adaptadores DVI"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,313
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores VGA"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,314
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Tarjetas para Red"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,34,89
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Accesorios para pantallas"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,35,94
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Adaptadores Tipo C"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,36,254,317
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Over Ear"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,39,255,119
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Tinta"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,135
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        if($nombreCategoria == "Tambor"){
                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);

                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2,43,135
                            ]);
		            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                                
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);
                
                            $items->save();
                            $logger->info($product['clave']." sku agregado");  
                        }
                        else{                                    
                            $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/productosSinSubcategoria.log');
                            $logger = new \Zend_Log();
                            $logger->addWriter($writer);
                            $logger->info("Productos:");
                            $logger->info("");

                            $items->setAttributeSetId(4);
                            $items->setName($product['nombre']." "."(".$product['numParte'].")");
                            $items->setSku($product['clave']);
                            $items->setPrice($precioReal);
                            $items->setVisibility(4);
                            $items->setStatus(1);
                            $items->setTypeId('simple');
                            $items->setTaxClassId(2);
                            $items->setWebsiteIds([1]);
                            $items->setShortDescription($product["descripcion_corta"]);                            
                            $items->setGtinEan($product['upc'] == "" || null ? $product['ean'] : $product['upc']);
                            $items->setBrandName($product['marca']);
                            $items->setProductCode($product['numParte']);  
                            $items->setCategoryIds([
                                2
                            ]);
                            $items->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                            if(count($product['promociones']) > 0){
                                if(@$product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $items->setSpecialPrice($precioPromocion);
                                    $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $items->setSpecialFromDateIsFormated(true);
                                    $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $items->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $items->setSpecialPrice($precioPromocion);
                                        $items->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $items->setSpecialFromDateIsFormated(true);
                                        $items->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $items->setSpecialToDateIsFormated(true);
                                    }                            
                                }
                            }
    
                            $filename = md5($product['imagen']); // LE DAMOS UN NUEVO NOMBRE
                            //if (!file_exists($mediaDir)) mkdir($mediaDir, 0777, true);
                            //else chmod($mediaDir, 0777);
                            $filepath = $mediaDir . '/catalog/product/imgct/' . $filename.'.jpg'; // SELECCIONAMOS UN PATH TEMPORAL
                            file_put_contents($filepath, file_get_contents(trim($product['imagen']))); // OBTENEMOS LA IMAGEN DE UNA URL EXTENA
                            $imgUrl = $filepath;
                            $items->addImageToMediaGallery($imgUrl, ['image', 'small_image', 'thumbnail'], false, false);                          
                            
                            $items->save();
                            $logger->info(
                                "sku agregado sin subcategoria".".- ".$product['clave']
                                ." "."Nombre de la categoria".".- ".$product["categoria"]
                                ." "."Nombre de la subcateoria".".- ".$product["subcateogia"]
                            );    
                        }                                 
                    }
                }  
            }
        }             
        catch (Exception $e) {
            $data = [];
        }
    }
   
    public function updateStock() {
        $jsonCT = $this->connectCT();        
        $data = file_get_contents("/home/imagended/productos.json");
        try{
            if($jsonCT){
                $products  = json_decode($data, true);
                foreach($products as $product){                
                    $producto = $this->productRepository->get($product['clave']);
                    if($producto){
                        $sumaExistencia = 0;
                        $pro = $product['existencia'];
                        foreach($pro as $existencia){
                            $sumaExistencia += $existencia;
                        }
                        $precioIva = $product['precio'] * 1.16;                
                        $precioivaxtipocambio = $precioIva * $product['tipoCambio'];
                        $precioReal = $precioivaxtipocambio * 1.05;
                        $numero_formateado = number_format($precioReal, 2, '.', '');
                        $precio_desgloce = explode(".",$numero_formateado);
                        $precioReal = $this->redondeo($precio_desgloce);

                        $producto->setName($product['nombre']." "."(".$product['numParte'].")");
                        $producto->setPrice($precioReal);
                        if($sumaExistencia < 10){
                            $producto->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 0,   
                                'qty' => 0
                                )
                            );
                        }
                        else{
                            $producto->setStockData(
                                array( 
                                'use_config_manage_stock' => 1,                       
                                'manage_stock' => 1,
                                'is_in_stock' => 1,   
                                'qty' => $sumaExistencia
                                )
                            );
                        }                
                            if(count($product['promociones']) > 0){
                                if($product['promociones'][0]['tipo'] == "importe"){
                                    $precioPromocion = $product['promociones'][0]['promocion'] * $product['tipoCambio'];
                                    $producto->setSpecialPrice($precioPromocion);
                                    $producto->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                    $producto->setSpecialFromDateIsFormated(true);
                                    $producto->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                    $producto->setSpecialToDateIsFormated(true);
                                }
                                else{
                                    if(@$product['promociones'][0]['tipo'] == "porcentaje"){
                                        $porcentaje = $product['promociones'][0]['promocion'] / 100;
                                        $valor = $precioReal * $porcentaje;
                                        $precioPromocion = $precioReal - $valor;
                                        $producto->setSpecialPrice($precioPromocion);
                                        $producto->setSpecialFromDate($product['promociones'][0]['vigencia']['inicio']);
                                        $producto->setSpecialFromDateIsFormated(true);
                                        $producto->setSpecialToDate($product['promociones'][0]['vigencia']['fin']);
                                        $producto->setSpecialToDateIsFormated(true);
                                    }                            
                                }   
                            }
                       
                        $this->productRepository->save($producto);
                    }               
                }
            }
        }catch (Exception $e) {
            $data = [];
        } 

    }

    public function syncvolumetria(){
        //CT
        $dataCt  = file_get_contents("/home/imagended/productos.json");    
        $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/volumetriaCT.log');
        $logger = new \Zend_Log();
        $logger->addWriter($writer);
        $logger->info("Inicio volumetria de CT");
        $logger->info("");        
        $productsData  = json_decode($dataCt, true);
        $success = $this->ctApiToken();
        $i = 1;
        if(isset($success["token"])){
            foreach($productsData as $product){
                $producto = $this->productRepository->get($product['clave']);
                if($producto){
                    $volumetria = $this->ctApiVolumetria($success["token"],$producto->getSku());
                    if($producto->getCtpeso() == 0 && $producto->getCtLargo() == 0 && $producto->getCtAlto() == 0 && $producto->getCtAncho() == 0){
                        if(isset($volumetria["errorCode"])){
                            $producto->setCtPeso(0);
                            $producto->setCtLargo(0);
                            $producto->setCtAlto(0);
                            $producto->setCtAncho(0);
                            $this->productRepository->save($producto);
                            $logger->info($i.".- "."Sku no encontrado en la API"." ".$producto->getSku());
                            $i++;
                        }
                        else{
                            $producto->setCtPeso($volumetria[0]["peso"]);
                            $producto->setCtLargo($volumetria[0]["largo"]);
                            $producto->setCtAlto($volumetria[0]["alto"]);
                            $producto->setCtAncho($volumetria[0]["ancho"]);
                            $this->productRepository->save($producto);
                            $logger->info($i.".- "."Sku actualizado"." ".$producto->getSku());
                            $i++;
                        }
                    }
                }
            }
        }
    }

    public function importSpecs(){
        $dataCt  = file_get_contents("/home/imagended/productos.json");
        $productsData  = json_decode($dataCt, true);
        foreach($productsData as $productdata){
            try{
                $producto = $this->productRepository->get($productdata['clave']);
                if($producto){
                    if(@$producto->getCtSpecs() == null){
                        if($productdata["especificaciones"] != null){
                            $specs = "<ul>";
                            foreach($productdata["especificaciones"] as $especificacion){
                                $specs .= "<li>"." ".$especificacion["tipo"].": ".$especificacion["valor"]."</li>";
                            }
                            $specs .= "</ul>";
                            $producto->setCtSpecs($specs);
                            $this->productRepository->save($producto);
                         }
                     }
                }
            }
            catch(Exception $e){
                $producto = null;
            }           
        }
    }
        
    public function connectCT(){
        //FTP
        // Configuración de la conexión FTP
        $ftp_server = '216.70.82.104'; // Reemplaza con la dirección del servidor FTP
        $ftp_user = 'HMO0410'; // Reemplaza con tu nombre de usuario FTP
        $ftp_pass = 'Z6v3Bh7*k@lLcXTGR0!P'; // Reemplaza con tu contraseña FTP

        // Ruta al archivo JSON en el servidor FTP
        $remote_file = 'catalogo_xml/productos.json'; // Reemplaza con la ruta de tu archivo JSON

        // Ruta local donde guardarás el archivo JSON descargado
        $local_file = '/home/imagended/productos.json'; // Reemplaza con la ruta de tu elección en tu servidor local

        // Establece la conexión FTP
        $ftp_conn = ftp_connect($ftp_server);
        if (!$ftp_conn) {
            die('No se pudo conectar al servidor FTP.');
        }

        // Inicia sesión en el servidor FTP
        if (ftp_login($ftp_conn, $ftp_user, $ftp_pass)) {
            // Descarga el archivo JSON
            if (ftp_get($ftp_conn, $local_file, $remote_file, FTP_ASCII, 0)) {
                return true;
            } else {
                return false;
            }

            // Cierra la conexión FTP
            ftp_close($ftp_conn);
        } else {
            echo "Error al iniciar sesión en el servidor FTP.";
        }
        //FIN FTP
    }
    
    public function redondeo($precio_desgloce){
        if(!isset($precio_desgloce[1])){
            return $precio_desgloce[0].".00";
        }
        #region switch para redondear centavos
        switch($precio_desgloce[1]){
            //00 
            case "00":
                return $precio_desgloce[0].".00";
            break;
            case "01":
                return $precio_desgloce[0].".00";
            break;
            case "02":
                return $precio_desgloce[0].".00";
            break;
            case "03":
                return $precio_desgloce[0].".00";
            break;
            case "04":
                return $precio_desgloce[0].".00";
            break;
            case "05":
                return $precio_desgloce[0].".10";
            break;
            case "06":
                return $precio_desgloce[0].".10";
            break;
            case "07":
                return $precio_desgloce[0].".10";
            break;
            case "08":
                return $precio_desgloce[0].".10";
            break;
            case "09":
                return $precio_desgloce[0].".10";
            break;
            case "10":
                return $precio_desgloce[0].".10";
            break;
            //10 >
            case "10":
                return $precio_desgloce[0].".10";
            break;
            case "11":
                return $precio_desgloce[0].".10";
            break;
            case "12":
                return $precio_desgloce[0].".10";
            break;
            case "13":
                return $precio_desgloce[0].".10";
            break;
            case "14":
                return $precio_desgloce[0].".10";
            break;
            case "15":
                return $precio_desgloce[0].".20";
            break;
            case "16":
                return $precio_desgloce[0].".20";
            break;
            case "17":
                return $precio_desgloce[0].".20";
            break;
            case "18":
                return $precio_desgloce[0].".20";
            break;
            case "19":
                return $precio_desgloce[0].".20";
            break;
            case "20":
                return $precio_desgloce[0].".20";
            break;
            //20
            case "20":
                return $precio_desgloce[0].".20";
            break;
            case "21":
                return $precio_desgloce[0].".20";
            break;
            case "22":
                return $precio_desgloce[0].".20";
            break;
            case "23":
                return $precio_desgloce[0].".20";
            break;
            case "24":
                return $precio_desgloce[0].".20";
            break;
            case "25":
                return $precio_desgloce[0].".30";
            break;
            case "26":
                return $precio_desgloce[0].".30";
            break;
            case "27":
                return $precio_desgloce[0].".30";
            break;
            case "28":
                return $precio_desgloce[0].".30";
            break;
            case "29":
                return $precio_desgloce[0].".30";
            break;
            case "30":
                return $precio_desgloce[0].".30";
            break;
            //30
            case "30":
                return $precio_desgloce[0].".30";
            break;
            case "31":
                return $precio_desgloce[0].".30";
            break;
            case "32":
                return $precio_desgloce[0].".30";
            break;
            case "33":
                return $precio_desgloce[0].".30";
            break;
            case "34":
                return $precio_desgloce[0].".30";
            break;
            case "35":
                return $precio_desgloce[0].".40";
            break;
            case "36":
                return $precio_desgloce[0].".40";
            break;
            case "37":
                return $precio_desgloce[0].".40";
            break;
            case "38":
                return $precio_desgloce[0].".40";
            break;
            case "39":
                return $precio_desgloce[0].".40";
            break;
            case "40":
                return $precio_desgloce[0].".40";
            break;
            //40
            case "40":
                return $precio_desgloce[0].".40";
            break;
            case "41":
                return $precio_desgloce[0].".40";
            break;
            case "42":
                return $precio_desgloce[0].".40";
            break;
            case "43":
                return $precio_desgloce[0].".40";
            break;
            case "44":
                return $precio_desgloce[0].".40";
            break;
            case "45":
                return $precio_desgloce[0].".50";
            break;
            case "46":
                return $precio_desgloce[0].".50";
            break;
            case "47":
                return $precio_desgloce[0].".50";
            break;
            case "48":
                return $precio_desgloce[0].".50";
            break;
            case "49":
                return $precio_desgloce[0].".50";
            break;
            case "50":
                return $precio_desgloce[0].".50";
            break;
            //50
            case "50":
                return $precio_desgloce[0].".50";
            break;
            case "51":
                return $precio_desgloce[0].".50";
            break;
            case "52":
                return $precio_desgloce[0].".50";
            break;
            case "53":
                return $precio_desgloce[0].".50";
            break;
            case "54":
                return $precio_desgloce[0].".50";
            break;
            case "55":
                return $precio_desgloce[0].".60";
            break;
            case "56":
                return $precio_desgloce[0].".60";
            break;
            case "57":
                return $precio_desgloce[0].".60";
            break;
            case "58":
                return $precio_desgloce[0].".60";
            break;
            case "59":
                return $precio_desgloce[0].".60";
            break;
            case "60":
                return $precio_desgloce[0].".60";
            break;
            //60
            case "60":
                return $precio_desgloce[0].".60";
            break;
            case "61":
                return $precio_desgloce[0].".60";
            break;
            case "62":
                return $precio_desgloce[0].".60";
            break;
            case "63":
                return $precio_desgloce[0].".60";
            break;
            case "64":
                return $precio_desgloce[0].".60";
            break;
            case "65":
                return $precio_desgloce[0].".70";
            break;
            case "66":
                return $precio_desgloce[0].".70";
            break;
            case "67":
                return $precio_desgloce[0].".70";
            break;
            case "68":
                return $precio_desgloce[0].".70";
            break;
            case "69":
                return $precio_desgloce[0].".70";
            break;
            case "70":
                return $precio_desgloce[0].".70";
            break;
            //70
            case "70":
                return $precio_desgloce[0].".70";
            break;
            case "71":
                return $precio_desgloce[0].".70";
            break;
            case "72":
                return $precio_desgloce[0].".70";
            break;
            case "73":
                return $precio_desgloce[0].".70";
            break;
            case "74":
                return $precio_desgloce[0].".70";
            break;
            case "75":
                return $precio_desgloce[0].".80";
            break;
            case "76":
                return $precio_desgloce[0].".80";
            break;
            case "77":
                return $precio_desgloce[0].".80";
            break;
            case "78":
                return $precio_desgloce[0].".80";
            break;
            case "79":
                return $precio_desgloce[0].".80";
            break;
            case "80":
                return $precio_desgloce[0].".80";
            break;
            //80
            case "80":
                return $precio_desgloce[0].".80";
            break;
            case "81":
                return $precio_desgloce[0].".80";
            break;
            case "82":
                return $precio_desgloce[0].".80";
            break;
            case "83":
                return $precio_desgloce[0].".80";
            break;
            case "84":
                return $precio_desgloce[0].".80";
            break;
            case "85":
                return $precio_desgloce[0].".90";
            break;
            case "86":
                return $precio_desgloce[0].".90";
            break;
            case "87":
                return $precio_desgloce[0].".90";
            break;
            case "88":
                return $precio_desgloce[0].".90";
            break;
            case "89":
                return $precio_desgloce[0].".90";
            break;
            case "90":
                return $precio_desgloce[0].".90";
            break;
            //90
            case "90":
                return $precio_desgloce[0].".90";
            break;
            case "91":
                return $precio_desgloce[0].".90";
            break;
            case "92":
                return $precio_desgloce[0].".90";
            break;
            case "93":
                return $precio_desgloce[0].".90";
            break;
            case "94":
                return $precio_desgloce[0].".90";
            break;
            case "95":
                $precio = $precio_desgloce[0];
                $precioReal = $precio + 1;
                return $precioReal.".00";
            break;
            case "96":
                $precio = $precio_desgloce[0];
                $precioReal = $precio + 1;
                return $precioReal.".00";
            break;
            case "97":
                $precio = $precio_desgloce[0];
                $precioReal = $precio + 1;
                return $precioReal.".00";
            break;
            case "98":
                $precio = $precio_desgloce[0];
                $precioReal = $precio + 1;
                return $precioReal.".00";
            break;
            case "99":
                $precio = $precio_desgloce[0];
                $precioReal = $precio + 1;
                return $precioReal.".00";
            break;            
            default:
            break;
        }
        #endregion

    }

    public function connectionAPI($dataI){
        // URL de la API a la que te deseas conectar
        $url = 'http://187.141.179.27/APIserve/index.php';
        // Datos que deseas enviar (por ejemplo, en formato JSON)
        $data = array(
            'datos' => $dataI
        );
        $data_string = json_encode($data);
        // Inicializar cURL
        $ch = curl_init($url);
        // Configurar la petición
        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST"); // Puedes cambiar "POST" a otros métodos como "GET" o "PUT".
        curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array(
            'Content-Type: application/json',
            'Content-Length: ' . strlen($data_string)
        ));
        // Ejecutar la petición
        $result = curl_exec($ch);
        // Verificar si hubo errores
        if (curl_errno($ch)) {
            $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/errorURL.log');
            $logger = new \Zend_Log();
            $logger->addWriter($writer);
            $logger->info(curl_error($ch));
        }
        // Cerrar la conexión cURL
        curl_close($ch);
        // Procesar la respuesta (puede ser JSON, XML, HTML, etc.)
        if ($result) {
            $response = json_decode($result, true);
            if($response){
                return $response;
            }
            else{
                return $response;
            }
        } else {
            echo 'No se recibió una respuesta válida.';
        }
    }

    public function ctApiToken(){
        // URL de la API a la que te deseas conectar
        $url = 'http://connect.ctonline.mx:3001/cliente/token';
        //$url = 'http://localhost/API/index.php';

        // Datos que deseas enviar (por ejemplo, en formato JSON)
        $data = array(
            "email" => "mario.flores@grupoqar.com",
            "cliente" => "HMO0410",
            "rfc"=> "NCO021021K82"
        );
        $data_string = json_encode($data);
        // Inicializar cURL
        $ch = curl_init($url);
        // Configurar la petición
        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST"); // Puedes cambiar "POST" a otros métodos como "GET" o "PUT".
        curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array(
            'Content-Type: application/json',
            'Content-Length: ' . strlen($data_string)
        ));
        // Ejecutar la petición
        $result = curl_exec($ch);
        // Verificar si hubo errores
        if (curl_errno($ch)) {
            $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/errorURL.log');
            $logger = new \Zend_Log();
            $logger->addWriter($writer);
            $logger->info(curl_error($ch));
        }
        // Cerrar la conexión cURL
        curl_close($ch);
        // Procesar la respuesta (puede ser JSON, XML, HTML, etc.)
        if ($result) {
            $response = json_decode($result, true);
            if($response){
                return $response;
            }
            else{
                return $response;
            }
        } else {
            echo 'No se recibió una respuesta válida.';
        }
    }

    public function ctApiVolumetria($token,$sku){
        // URL de la API a la que te deseas conectar
        $url = 'http://connect.ctonline.mx:3001/paqueteria/volumetria/'.$sku;
        //$url = 'http://localhost/API/index.php';

        // Configuración de la solicitud
        $curl = curl_init($url);
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($curl, CURLOPT_HTTPHEADER, [
            'x-auth:' . $token,
            // Otros encabezados si es necesario
        ]);
        // Ejecutar la petición
        $result = curl_exec($curl);
        // Verificar si hubo errores
        if (curl_errno($curl)) {
            $writer = new \Zend_Log_Writer_Stream(BP . '/var/log/errorURL.log');
            $logger = new \Zend_Log();
            $logger->addWriter($writer);
            $logger->info(curl_error($curl));
        }
        // Cerrar la conexión cURL
        curl_close($curl);
        // Procesar la respuesta (puede ser JSON, XML, HTML, etc.)
        if ($result) {
            $response = json_decode($result, true);
            if($response){
                return $response;
            }
            else{
                return $response;
            }
        } else {
            echo 'No se recibió una respuesta válida.';
        }
    }
}
